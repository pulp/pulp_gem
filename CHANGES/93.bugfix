Optimized publish task to be significantly faster.